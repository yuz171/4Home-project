{"ast":null,"code":"var _jsxFileName = \"E:\\\\react-project\\\\hkzf-mobile\\\\src\\\\components\\\\Sticky\\\\index.js\";\nimport React, { Component, createRef } from 'react';\nimport PropTypes from 'prop-types';\nimport styles from './index.module.css'; // dom.getBoundingClientRect() 获取元素的大小及其相对于视口的位置。\n\n/* \r\n  条件筛选栏吸顶功能实现步骤：\r\n\r\n  1 封装 Sticky 组件，实现吸顶功能。\r\n  2 在 HouseList 页面中，导入 Sticky 组件。\r\n  3 使用 Sticky 组件包裹要实现吸顶功能的 Filter 组件。\r\n\r\n  4 在 Sticky 组件中，创建两个 ref 对象（placeholder、content），分别指向占位元素和内容元素。\r\n  5 组件中，监听浏览器的 scroll 事件（注意销毁事件）。\r\n  6 在 scroll 事件中，通过 getBoundingClientRect() 方法得到筛选栏占位元素当前位置（top）。\r\n  7 判断 top 是否小于 0（是否在可视区内）。\r\n  8 如果小于，就添加需要吸顶样式（fixed），同时设置占位元素高度（与条件筛选栏高度相同）。\r\n  9 否则，就移除吸顶样式，同时让占位元素高度为 0。\r\n*/\n\nclass Sticky extends Component {\n  constructor(...args) {\n    super(...args);\n    this.placeholder = createRef();\n    this.content = createRef();\n\n    this.handleScroll = () => {\n      const height = this.props.height; // 获取DOM对象\n\n      const placeholderEl = this.placeholder.current;\n      const contentEl = this.content.current;\n\n      const _placeholderEl$getBou = placeholderEl.getBoundingClientRect(),\n            top = _placeholderEl$getBou.top;\n\n      if (top < 0) {\n        // 吸顶\n        contentEl.classList.add(styles.fixed);\n        placeholderEl.style.height = \"\".concat(height, \"px\");\n      } else {\n        // 取消吸顶\n        contentEl.classList.remove(styles.fixed);\n        placeholderEl.style.height = '0px';\n      }\n    };\n  }\n\n  // 监听 scroll 事件\n  componentDidMount() {\n    window.addEventListener('scroll', this.handleScroll);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('scroll', this.handleScroll);\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      ref: this.placeholder,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      ref: this.content,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63\n      },\n      __self: this\n    }, this.props.children));\n  }\n\n}\n\nSticky.propTypes = {\n  height: PropTypes.number.isRequired\n};\nexport default Sticky;","map":{"version":3,"sources":["E:\\react-project\\hkzf-mobile\\src\\components\\Sticky\\index.js"],"names":["React","Component","createRef","PropTypes","styles","Sticky","placeholder","content","handleScroll","height","props","placeholderEl","current","contentEl","getBoundingClientRect","top","classList","add","fixed","style","remove","componentDidMount","window","addEventListener","componentWillUnmount","removeEventListener","render","children","propTypes","number","isRequired"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,SAA3B,QAA4C,OAA5C;AAEA,OAAOC,SAAP,MAAsB,YAAtB;AAEA,OAAOC,MAAP,MAAmB,oBAAnB,C,CAEA;;AAEA;;;;;;;;;;;;;;;AAeA,MAAMC,MAAN,SAAqBJ,SAArB,CAA+B;AAAA;AAAA;AAAA,SAE7BK,WAF6B,GAEfJ,SAAS,EAFM;AAAA,SAG7BK,OAH6B,GAGnBL,SAAS,EAHU;;AAAA,SAM7BM,YAN6B,GAMd,MAAM;AAAA,YACXC,MADW,GACA,KAAKC,KADL,CACXD,MADW,EAEnB;;AACA,YAAME,aAAa,GAAG,KAAKL,WAAL,CAAiBM,OAAvC;AACA,YAAMC,SAAS,GAAG,KAAKN,OAAL,CAAaK,OAA/B;;AAJmB,oCAMHD,aAAa,CAACG,qBAAd,EANG;AAAA,YAMXC,GANW,yBAMXA,GANW;;AAOnB,UAAIA,GAAG,GAAG,CAAV,EAAa;AACX;AACAF,QAAAA,SAAS,CAACG,SAAV,CAAoBC,GAApB,CAAwBb,MAAM,CAACc,KAA/B;AACAP,QAAAA,aAAa,CAACQ,KAAd,CAAoBV,MAApB,aAAgCA,MAAhC;AACD,OAJD,MAIO;AACL;AACAI,QAAAA,SAAS,CAACG,SAAV,CAAoBI,MAApB,CAA2BhB,MAAM,CAACc,KAAlC;AACAP,QAAAA,aAAa,CAACQ,KAAd,CAAoBV,MAApB,GAA6B,KAA7B;AACD;AACF,KAtB4B;AAAA;;AAwB7B;AACAY,EAAAA,iBAAiB,GAAG;AAClBC,IAAAA,MAAM,CAACC,gBAAP,CAAwB,QAAxB,EAAkC,KAAKf,YAAvC;AACD;;AAEDgB,EAAAA,oBAAoB,GAAG;AACrBF,IAAAA,MAAM,CAACG,mBAAP,CAA2B,QAA3B,EAAqC,KAAKjB,YAA1C;AACD;;AAEDkB,EAAAA,MAAM,GAAG;AACP,WACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEE;AAAK,MAAA,GAAG,EAAE,KAAKpB,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,EAIE;AAAK,MAAA,GAAG,EAAE,KAAKC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAyB,KAAKG,KAAL,CAAWiB,QAApC,CAJF,CADF;AAQD;;AA1C4B;;AA6C/BtB,MAAM,CAACuB,SAAP,GAAmB;AACjBnB,EAAAA,MAAM,EAAEN,SAAS,CAAC0B,MAAV,CAAiBC;AADR,CAAnB;AAIA,eAAezB,MAAf","sourcesContent":["import React, { Component, createRef } from 'react'\r\n\r\nimport PropTypes from 'prop-types'\r\n\r\nimport styles from './index.module.css'\r\n\r\n// dom.getBoundingClientRect() 获取元素的大小及其相对于视口的位置。\r\n\r\n/* \r\n  条件筛选栏吸顶功能实现步骤：\r\n\r\n  1 封装 Sticky 组件，实现吸顶功能。\r\n  2 在 HouseList 页面中，导入 Sticky 组件。\r\n  3 使用 Sticky 组件包裹要实现吸顶功能的 Filter 组件。\r\n\r\n  4 在 Sticky 组件中，创建两个 ref 对象（placeholder、content），分别指向占位元素和内容元素。\r\n  5 组件中，监听浏览器的 scroll 事件（注意销毁事件）。\r\n  6 在 scroll 事件中，通过 getBoundingClientRect() 方法得到筛选栏占位元素当前位置（top）。\r\n  7 判断 top 是否小于 0（是否在可视区内）。\r\n  8 如果小于，就添加需要吸顶样式（fixed），同时设置占位元素高度（与条件筛选栏高度相同）。\r\n  9 否则，就移除吸顶样式，同时让占位元素高度为 0。\r\n*/\r\n\r\nclass Sticky extends Component {\r\n  // 创建ref对象\r\n  placeholder = createRef()\r\n  content = createRef()\r\n\r\n  // scroll 事件的事件处理程序\r\n  handleScroll = () => {\r\n    const { height } = this.props\r\n    // 获取DOM对象\r\n    const placeholderEl = this.placeholder.current\r\n    const contentEl = this.content.current\r\n\r\n    const { top } = placeholderEl.getBoundingClientRect()\r\n    if (top < 0) {\r\n      // 吸顶\r\n      contentEl.classList.add(styles.fixed)\r\n      placeholderEl.style.height = `${height}px`\r\n    } else {\r\n      // 取消吸顶\r\n      contentEl.classList.remove(styles.fixed)\r\n      placeholderEl.style.height = '0px'\r\n    }\r\n  }\r\n\r\n  // 监听 scroll 事件\r\n  componentDidMount() {\r\n    window.addEventListener('scroll', this.handleScroll)\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener('scroll', this.handleScroll)\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        {/* 占位元素 */}\r\n        <div ref={this.placeholder} />\r\n        {/* 内容元素 */}\r\n        <div ref={this.content}>{this.props.children}</div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nSticky.propTypes = {\r\n  height: PropTypes.number.isRequired\r\n}\r\n\r\nexport default Sticky\r\n"]},"metadata":{},"sourceType":"module"}