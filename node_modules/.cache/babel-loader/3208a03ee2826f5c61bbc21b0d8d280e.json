{"ast":null,"code":"import \"antd-mobile/lib/flex/style/css\";\nimport _Flex from \"antd-mobile/lib/flex\";\nimport \"antd-mobile/lib/carousel/style/css\";\nimport _Carousel from \"antd-mobile/lib/carousel\";\nimport \"antd-mobile/lib/toast/style/css\";\nimport _Toast from \"antd-mobile/lib/toast\";\nimport \"antd-mobile/lib/modal/style/css\";\nimport _Modal from \"antd-mobile/lib/modal\";\nvar _jsxFileName = \"E:\\\\react-project\\\\hkzf-mobile\\\\src\\\\pages\\\\HouseDetail\\\\index.js\";\nimport React, { Component } from 'react';\nimport NavHeader from '../../components/NavHeader';\nimport HouseItem from '../../components/HouseItem';\nimport HousePackage from '../../components/HousePackage'; // import { BASE_URL } from '../../utils/url'\n// import { API } from '../../utils/api'\n\nimport { isAuth, BASE_URL, API } from '../../utils';\nimport styles from './index.module.css'; // 猜你喜欢\n\nconst recommendHouses = [{\n  id: 1,\n  src: BASE_URL + '/img/message/1.png',\n  desc: '72.32㎡/南 北/低楼层',\n  title: '安贞西里 3室1厅',\n  price: 4500,\n  tags: ['随时看房']\n}, {\n  id: 2,\n  src: BASE_URL + '/img/message/2.png',\n  desc: '83㎡/南/高楼层',\n  title: '天居园 2室1厅',\n  price: 7200,\n  tags: ['近地铁']\n}, {\n  id: 3,\n  src: BASE_URL + '/img/message/3.png',\n  desc: '52㎡/西南/低楼层',\n  title: '角门甲4号院 1室1厅',\n  price: 4300,\n  tags: ['集中供暖']\n}]; // 百度地图\n\nconst BMap = window.BMap;\nconst labelStyle = {\n  position: 'absolute',\n  zIndex: -7982820,\n  backgroundColor: 'rgb(238, 93, 91)',\n  color: 'rgb(255, 255, 255)',\n  height: 25,\n  padding: '5px 10px',\n  lineHeight: '14px',\n  borderRadius: 3,\n  boxShadow: 'rgb(204, 204, 204) 2px 2px 2px',\n  whiteSpace: 'nowrap',\n  fontSize: 12,\n  userSelect: 'none'\n};\nconst alert = _Modal.alert;\nexport default class HouseDetail extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      // 数据加载中状态\n      isLoading: false,\n      // 房屋详情\n      houseInfo: {\n        // 房屋图片\n        houseImg: [],\n        // 标题\n        title: '',\n        // 标签\n        tags: [],\n        // 租金\n        price: 0,\n        // 房型\n        roomType: '',\n        // 房屋面积\n        size: 0,\n        // 朝向\n        oriented: [],\n        // 楼层\n        floor: '',\n        // 小区名称\n        community: '',\n        // 地理位置\n        coord: {\n          latitude: '39.928033',\n          longitude: '116.529466'\n        },\n        // 房屋配套\n        supporting: [],\n        // 房屋标识\n        houseCode: '',\n        // 房屋描述\n        description: ''\n      },\n      // 表示房源是否收藏\n      isFavorite: false\n    };\n\n    this.handleFavorite = async () => {\n      const isLogin = isAuth();\n      const _this$props = this.props,\n            history = _this$props.history,\n            location = _this$props.location,\n            match = _this$props.match;\n\n      if (!isLogin) {\n        // 未登录\n        return alert('提示', '登录后才能收藏房源，是否去登录?', [{\n          text: '取消'\n        }, {\n          text: '去登录',\n          // 使用 replace 方法，解决登录后返回详情页面，再点击左上角返回按钮时\n          // 需要点击两次的问题\n          // onPress: () => history.push('/login', { from: location })\n          onPress: () => history.replace('/login', {\n            from: location\n          })\n        }]);\n      } // 已登录\n\n\n      const isFavorite = this.state.isFavorite;\n      const id = match.params.id;\n\n      if (isFavorite) {\n        // 已收藏，应该删除收藏\n        const res = await API.delete(\"/user/favorites/\".concat(id)); // console.log(res)\n\n        this.setState({\n          isFavorite: false\n        });\n\n        if (res.data.status === 200) {\n          // 提示用户取消收藏\n          _Toast.info('已取消收藏', 1, null, false);\n        } else {\n          // token 超时\n          _Toast.info('登录超时，请重新登录', 2, null, false);\n        }\n      } else {\n        // 未收藏，应该添加收藏\n        const res = await API.post(\"/user/favorites/\".concat(id)); // console.log(res)\n\n        if (res.data.status === 200) {\n          // 提示用户收藏成功\n          _Toast.info('已收藏', 1, null, false);\n\n          this.setState({\n            isFavorite: true\n          });\n        } else {\n          // token 超时\n          _Toast.info('登录超时，请重新登录', 2, null, false);\n        }\n      }\n    };\n  }\n\n  componentDidMount() {\n    // 获取配置好的路由参数：\n    // console.log('路由参数对象：', this.props.match.params)\n    // console.log(this.props)\n    // 获取房屋数据\n    this.getHouseDetail(); // 检查房源是否收藏\n\n    this.checkFavorite();\n  } // 检查房源是否收藏：\n\n\n  async checkFavorite() {\n    const isLogin = isAuth();\n\n    if (!isLogin) {\n      // 没有登录\n      return;\n    } // 已登录\n\n\n    const id = this.props.match.params.id;\n    const res = await API.get(\"/user/favorites/\".concat(id));\n    const _res$data = res.data,\n          status = _res$data.status,\n          body = _res$data.body;\n\n    if (status === 200) {\n      // 表示请求已经成功，需要更新 isFavorite 的值\n      this.setState({\n        isFavorite: body.isFavorite\n      });\n    }\n  }\n  /* \r\n    收藏房源：\r\n      1 给收藏按钮绑定单击事件，创建方法 handleFavorite 作为事件处理程序。\r\n    2 调用 isAuth 方法，判断是否登录。\r\n    3 如果未登录，则使用 Modal.alert 提示用户是否去登录。\r\n    4 如果点击取消，则不做任何操作。\r\n    5 如果点击去登录，就跳转到登录页面，同时传递 state（登录后，再回到房源收藏页面）。\r\n    \r\n    6 根据 isFavorite 判断，当前房源是否收藏。\r\n    7 如果未收藏，就调用添加收藏接口，添加收藏。\r\n    8 如果已收藏，就调用删除收藏接口，去除收藏。\r\n      alert('提示', '登录后才能收藏房源，是否去登录?', [\r\n      { text: '取消' },\r\n      {\r\n        text: '去登录',\r\n        onPress: () => {}\r\n      }\r\n    ])\r\n  */\n\n\n  // 获取房屋详细信息\n  async getHouseDetail() {\n    const id = this.props.match.params.id; // 开启loading\n\n    this.setState({\n      isLoading: true\n    });\n    const res = await API.get(\"/houses/\".concat(id)); // console.log(res.data.body)\n\n    this.setState({\n      houseInfo: res.data.body,\n      isLoading: false\n    });\n    const _res$data$body = res.data.body,\n          community = _res$data$body.community,\n          coord = _res$data$body.coord; // 渲染地图\n\n    this.renderMap(community, coord);\n  } // 渲染轮播图结构\n\n\n  renderSwipers() {\n    const houseImg = this.state.houseInfo.houseImg;\n    return houseImg.map(item => React.createElement(\"a\", {\n      key: item,\n      href: \"http://itcast.cn\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: BASE_URL + item,\n      alt: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247\n      },\n      __self: this\n    })));\n  } // 渲染地图\n\n\n  renderMap(community, coord) {\n    const latitude = coord.latitude,\n          longitude = coord.longitude;\n    const map = new BMap.Map('map');\n    const point = new BMap.Point(longitude, latitude);\n    map.centerAndZoom(point, 17);\n    const label = new BMap.Label('', {\n      position: point,\n      offset: new BMap.Size(0, -36)\n    });\n    label.setStyle(labelStyle);\n    label.setContent(\"\\n      <span>\".concat(community, \"</span>\\n      <div class=\\\"\").concat(styles.mapArrow, \"\\\"></div>\\n    \"));\n    map.addOverlay(label);\n  } // 渲染标签\n\n\n  renderTags() {\n    const tags = this.state.houseInfo.tags;\n    return tags.map((item, index) => {\n      // 如果标签数量超过3个，后面的标签就都展示位第三个标签的样式\n      let tagClass = '';\n\n      if (index > 2) {\n        tagClass = 'tag3';\n      } else {\n        tagClass = 'tag' + (index + 1);\n      }\n\n      return React.createElement(\"span\", {\n        key: item,\n        className: [styles.tag, styles[tagClass]].join(' '),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 289\n        },\n        __self: this\n      }, item);\n    });\n  }\n\n  render() {\n    const _this$state = this.state,\n          isLoading = _this$state.isLoading,\n          _this$state$houseInfo = _this$state.houseInfo,\n          community = _this$state$houseInfo.community,\n          title = _this$state$houseInfo.title,\n          price = _this$state$houseInfo.price,\n          roomType = _this$state$houseInfo.roomType,\n          size = _this$state$houseInfo.size,\n          floor = _this$state$houseInfo.floor,\n          oriented = _this$state$houseInfo.oriented,\n          supporting = _this$state$houseInfo.supporting,\n          description = _this$state$houseInfo.description,\n          isFavorite = _this$state.isFavorite;\n    return React.createElement(\"div\", {\n      className: styles.root,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 313\n      },\n      __self: this\n    }, React.createElement(NavHeader, {\n      className: styles.navHeader,\n      rightContent: [React.createElement(\"i\", {\n        key: \"share\",\n        className: \"iconfont icon-share\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 317\n        },\n        __self: this\n      })],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 315\n      },\n      __self: this\n    }, community), React.createElement(\"div\", {\n      className: styles.slides,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323\n      },\n      __self: this\n    }, !isLoading ? React.createElement(_Carousel, {\n      autoplay: true,\n      infinite: true,\n      autoplayInterval: 5000,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 325\n      },\n      __self: this\n    }, this.renderSwipers()) : ''), React.createElement(\"div\", {\n      className: styles.info,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 334\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      className: styles.infoTitle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 335\n      },\n      __self: this\n    }, title), React.createElement(_Flex, {\n      className: styles.tags,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 336\n      },\n      __self: this\n    }, React.createElement(_Flex.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 337\n      },\n      __self: this\n    }, this.renderTags())), React.createElement(_Flex, {\n      className: styles.infoPrice,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 340\n      },\n      __self: this\n    }, React.createElement(_Flex.Item, {\n      className: styles.infoPriceItem,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342\n      },\n      __self: this\n    }, price, React.createElement(\"span\", {\n      className: styles.month,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 344\n      },\n      __self: this\n    }, \"/\\u6708\")), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 346\n      },\n      __self: this\n    }, \"\\u79DF\\u91D1\")), React.createElement(_Flex.Item, {\n      className: styles.infoPriceItem,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 348\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 349\n      },\n      __self: this\n    }, roomType), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 350\n      },\n      __self: this\n    }, \"\\u623F\\u578B\")), React.createElement(_Flex.Item, {\n      className: styles.infoPriceItem,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 352\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 353\n      },\n      __self: this\n    }, size, \"\\u5E73\\u7C73\"), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 354\n      },\n      __self: this\n    }, \"\\u9762\\u79EF\"))), React.createElement(_Flex, {\n      className: styles.infoBasic,\n      align: \"start\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 358\n      },\n      __self: this\n    }, React.createElement(_Flex.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 359\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 360\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: styles.title,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 361\n      },\n      __self: this\n    }, \"\\u88C5\\u4FEE\\uFF1A\"), \"\\u7CBE\\u88C5\"), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 364\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: styles.title,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 365\n      },\n      __self: this\n    }, \"\\u697C\\u5C42\\uFF1A\"), floor)), React.createElement(_Flex.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 369\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 370\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: styles.title,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 371\n      },\n      __self: this\n    }, \"\\u671D\\u5411\\uFF1A\"), oriented.join('、')), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 374\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: styles.title,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 375\n      },\n      __self: this\n    }, \"\\u7C7B\\u578B\\uFF1A\"), \"\\u666E\\u901A\\u4F4F\\u5B85\")))), React.createElement(\"div\", {\n      className: styles.map,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 382\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: styles.mapTitle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 383\n      },\n      __self: this\n    }, \"\\u5C0F\\u533A\\uFF1A\", React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 385\n      },\n      __self: this\n    }, community)), React.createElement(\"div\", {\n      className: styles.mapContainer,\n      id: \"map\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 387\n      },\n      __self: this\n    }, \"\\u5730\\u56FE\")), React.createElement(\"div\", {\n      className: styles.about,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 393\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: styles.houseTitle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 394\n      },\n      __self: this\n    }, \"\\u623F\\u5C4B\\u914D\\u5957\"), supporting.length === 0 ? React.createElement(\"div\", {\n      className: styles.titleEmpty,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 399\n      },\n      __self: this\n    }, \"\\u6682\\u65E0\\u6570\\u636E\") : React.createElement(HousePackage, {\n      list: supporting,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 401\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: styles.set,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 406\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: styles.houseTitle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 407\n      },\n      __self: this\n    }, \"\\u623F\\u6E90\\u6982\\u51B5\"), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 408\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: styles.contact,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 409\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: styles.user,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 410\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: BASE_URL + '/img/avatar.png',\n      alt: \"\\u5934\\u50CF\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 411\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: styles.useInfo,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 412\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 413\n      },\n      __self: this\n    }, \"\\u738B\\u5973\\u58EB\"), React.createElement(\"div\", {\n      className: styles.userAuth,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 414\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"iconfont icon-auth\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 415\n      },\n      __self: this\n    }), \"\\u5DF2\\u8BA4\\u8BC1\\u623F\\u4E3B\"))), React.createElement(\"span\", {\n      className: styles.userMsg,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 420\n      },\n      __self: this\n    }, \"\\u53D1\\u6D88\\u606F\")), React.createElement(\"div\", {\n      className: styles.descText,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 423\n      },\n      __self: this\n    }, description || '暂无房屋描述'))), React.createElement(\"div\", {\n      className: styles.recommend,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 430\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: styles.houseTitle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 431\n      },\n      __self: this\n    }, \"\\u731C\\u4F60\\u559C\\u6B22\"), React.createElement(\"div\", {\n      className: styles.items,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 432\n      },\n      __self: this\n    }, recommendHouses.map(item => React.createElement(HouseItem, Object.assign({}, item, {\n      key: item.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 434\n      },\n      __self: this\n    }))))), React.createElement(_Flex, {\n      className: styles.fixedBottom,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 440\n      },\n      __self: this\n    }, React.createElement(_Flex.Item, {\n      onClick: this.handleFavorite,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 441\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: BASE_URL + (isFavorite ? '/img/star.png' : '/img/unstar.png'),\n      className: styles.favoriteImg,\n      alt: \"\\u6536\\u85CF\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 442\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      className: styles.favorite,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 449\n      },\n      __self: this\n    }, isFavorite ? '已收藏' : '收藏')), React.createElement(_Flex.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 453\n      },\n      __self: this\n    }, \"\\u5728\\u7EBF\\u54A8\\u8BE2\"), React.createElement(_Flex.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 454\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      href: \"tel:400-618-4000\",\n      className: styles.telephone,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 455\n      },\n      __self: this\n    }, \"\\u7535\\u8BDD\\u9884\\u7EA6\"))));\n  }\n\n}","map":{"version":3,"sources":["E:\\react-project\\hkzf-mobile\\src\\pages\\HouseDetail\\index.js"],"names":["React","Component","NavHeader","HouseItem","HousePackage","isAuth","BASE_URL","API","styles","recommendHouses","id","src","desc","title","price","tags","BMap","window","labelStyle","position","zIndex","backgroundColor","color","height","padding","lineHeight","borderRadius","boxShadow","whiteSpace","fontSize","userSelect","alert","HouseDetail","state","isLoading","houseInfo","houseImg","roomType","size","oriented","floor","community","coord","latitude","longitude","supporting","houseCode","description","isFavorite","handleFavorite","isLogin","props","history","location","match","text","onPress","replace","from","params","res","delete","setState","data","status","info","post","componentDidMount","getHouseDetail","checkFavorite","get","body","renderMap","renderSwipers","map","item","Map","point","Point","centerAndZoom","label","Label","offset","Size","setStyle","setContent","mapArrow","addOverlay","renderTags","index","tagClass","tag","join","render","root","navHeader","slides","infoTitle","infoPrice","infoPriceItem","month","infoBasic","mapTitle","mapContainer","about","houseTitle","length","titleEmpty","set","contact","user","useInfo","userAuth","userMsg","descText","recommend","items","fixedBottom","favoriteImg","favorite","telephone"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\n\r\nimport { Carousel, Flex, Modal, Toast } from 'antd-mobile'\r\n\r\nimport NavHeader from '../../components/NavHeader'\r\nimport HouseItem from '../../components/HouseItem'\r\nimport HousePackage from '../../components/HousePackage'\r\n\r\n// import { BASE_URL } from '../../utils/url'\r\n// import { API } from '../../utils/api'\r\nimport { isAuth, BASE_URL, API } from '../../utils'\r\n\r\nimport styles from './index.module.css'\r\n\r\n// 猜你喜欢\r\nconst recommendHouses = [\r\n  {\r\n    id: 1,\r\n    src: BASE_URL + '/img/message/1.png',\r\n    desc: '72.32㎡/南 北/低楼层',\r\n    title: '安贞西里 3室1厅',\r\n    price: 4500,\r\n    tags: ['随时看房']\r\n  },\r\n  {\r\n    id: 2,\r\n    src: BASE_URL + '/img/message/2.png',\r\n    desc: '83㎡/南/高楼层',\r\n    title: '天居园 2室1厅',\r\n    price: 7200,\r\n    tags: ['近地铁']\r\n  },\r\n  {\r\n    id: 3,\r\n    src: BASE_URL + '/img/message/3.png',\r\n    desc: '52㎡/西南/低楼层',\r\n    title: '角门甲4号院 1室1厅',\r\n    price: 4300,\r\n    tags: ['集中供暖']\r\n  }\r\n]\r\n\r\n// 百度地图\r\nconst BMap = window.BMap\r\n\r\nconst labelStyle = {\r\n  position: 'absolute',\r\n  zIndex: -7982820,\r\n  backgroundColor: 'rgb(238, 93, 91)',\r\n  color: 'rgb(255, 255, 255)',\r\n  height: 25,\r\n  padding: '5px 10px',\r\n  lineHeight: '14px',\r\n  borderRadius: 3,\r\n  boxShadow: 'rgb(204, 204, 204) 2px 2px 2px',\r\n  whiteSpace: 'nowrap',\r\n  fontSize: 12,\r\n  userSelect: 'none'\r\n}\r\n\r\nconst alert = Modal.alert\r\n\r\nexport default class HouseDetail extends Component {\r\n  state = {\r\n    // 数据加载中状态\r\n    isLoading: false,\r\n\r\n    // 房屋详情\r\n    houseInfo: {\r\n      // 房屋图片\r\n      houseImg: [],\r\n      // 标题\r\n      title: '',\r\n      // 标签\r\n      tags: [],\r\n      // 租金\r\n      price: 0,\r\n      // 房型\r\n      roomType: '',\r\n      // 房屋面积\r\n      size: 0,\r\n      // 朝向\r\n      oriented: [],\r\n      // 楼层\r\n      floor: '',\r\n      // 小区名称\r\n      community: '',\r\n      // 地理位置\r\n      coord: {\r\n        latitude: '39.928033',\r\n        longitude: '116.529466'\r\n      },\r\n      // 房屋配套\r\n      supporting: [],\r\n      // 房屋标识\r\n      houseCode: '',\r\n      // 房屋描述\r\n      description: ''\r\n    },\r\n\r\n    // 表示房源是否收藏\r\n    isFavorite: false\r\n  }\r\n\r\n  componentDidMount() {\r\n    // 获取配置好的路由参数：\r\n    // console.log('路由参数对象：', this.props.match.params)\r\n    // console.log(this.props)\r\n\r\n    // 获取房屋数据\r\n    this.getHouseDetail()\r\n\r\n    // 检查房源是否收藏\r\n    this.checkFavorite()\r\n  }\r\n\r\n  // 检查房源是否收藏：\r\n  async checkFavorite() {\r\n    const isLogin = isAuth()\r\n\r\n    if (!isLogin) {\r\n      // 没有登录\r\n      return\r\n    }\r\n\r\n    // 已登录\r\n    const { id } = this.props.match.params\r\n    const res = await API.get(`/user/favorites/${id}`)\r\n\r\n    const { status, body } = res.data\r\n    if (status === 200) {\r\n      // 表示请求已经成功，需要更新 isFavorite 的值\r\n      this.setState({\r\n        isFavorite: body.isFavorite\r\n      })\r\n    }\r\n  }\r\n\r\n  /* \r\n    收藏房源：\r\n\r\n    1 给收藏按钮绑定单击事件，创建方法 handleFavorite 作为事件处理程序。\r\n    2 调用 isAuth 方法，判断是否登录。\r\n    3 如果未登录，则使用 Modal.alert 提示用户是否去登录。\r\n    4 如果点击取消，则不做任何操作。\r\n    5 如果点击去登录，就跳转到登录页面，同时传递 state（登录后，再回到房源收藏页面）。\r\n    \r\n    6 根据 isFavorite 判断，当前房源是否收藏。\r\n    7 如果未收藏，就调用添加收藏接口，添加收藏。\r\n    8 如果已收藏，就调用删除收藏接口，去除收藏。\r\n\r\n    alert('提示', '登录后才能收藏房源，是否去登录?', [\r\n      { text: '取消' },\r\n      {\r\n        text: '去登录',\r\n        onPress: () => {}\r\n      }\r\n    ])\r\n  */\r\n\r\n  handleFavorite = async () => {\r\n    const isLogin = isAuth()\r\n    const { history, location, match } = this.props\r\n\r\n    if (!isLogin) {\r\n      // 未登录\r\n      return alert('提示', '登录后才能收藏房源，是否去登录?', [\r\n        { text: '取消' },\r\n        {\r\n          text: '去登录',\r\n          // 使用 replace 方法，解决登录后返回详情页面，再点击左上角返回按钮时\r\n          // 需要点击两次的问题\r\n          // onPress: () => history.push('/login', { from: location })\r\n          onPress: () => history.replace('/login', { from: location })\r\n        }\r\n      ])\r\n    }\r\n\r\n    // 已登录\r\n    const { isFavorite } = this.state\r\n    const { id } = match.params\r\n\r\n    if (isFavorite) {\r\n      // 已收藏，应该删除收藏\r\n      const res = await API.delete(`/user/favorites/${id}`)\r\n      // console.log(res)\r\n      this.setState({\r\n        isFavorite: false\r\n      })\r\n\r\n      if (res.data.status === 200) {\r\n        // 提示用户取消收藏\r\n        Toast.info('已取消收藏', 1, null, false)\r\n      } else {\r\n        // token 超时\r\n        Toast.info('登录超时，请重新登录', 2, null, false)\r\n      }\r\n    } else {\r\n      // 未收藏，应该添加收藏\r\n      const res = await API.post(`/user/favorites/${id}`)\r\n      // console.log(res)\r\n      if (res.data.status === 200) {\r\n        // 提示用户收藏成功\r\n        Toast.info('已收藏', 1, null, false)\r\n        this.setState({\r\n          isFavorite: true\r\n        })\r\n      } else {\r\n        // token 超时\r\n        Toast.info('登录超时，请重新登录', 2, null, false)\r\n      }\r\n    }\r\n  }\r\n\r\n  // 获取房屋详细信息\r\n  async getHouseDetail() {\r\n    const { id } = this.props.match.params\r\n\r\n    // 开启loading\r\n    this.setState({\r\n      isLoading: true\r\n    })\r\n\r\n    const res = await API.get(`/houses/${id}`)\r\n\r\n    // console.log(res.data.body)\r\n\r\n    this.setState({\r\n      houseInfo: res.data.body,\r\n      isLoading: false\r\n    })\r\n\r\n    const { community, coord } = res.data.body\r\n\r\n    // 渲染地图\r\n    this.renderMap(community, coord)\r\n  }\r\n\r\n  // 渲染轮播图结构\r\n  renderSwipers() {\r\n    const {\r\n      houseInfo: { houseImg }\r\n    } = this.state\r\n\r\n    return houseImg.map(item => (\r\n      <a key={item} href=\"http://itcast.cn\">\r\n        <img src={BASE_URL + item} alt=\"\" />\r\n      </a>\r\n    ))\r\n  }\r\n\r\n  // 渲染地图\r\n  renderMap(community, coord) {\r\n    const { latitude, longitude } = coord\r\n\r\n    const map = new BMap.Map('map')\r\n    const point = new BMap.Point(longitude, latitude)\r\n    map.centerAndZoom(point, 17)\r\n\r\n    const label = new BMap.Label('', {\r\n      position: point,\r\n      offset: new BMap.Size(0, -36)\r\n    })\r\n\r\n    label.setStyle(labelStyle)\r\n    label.setContent(`\r\n      <span>${community}</span>\r\n      <div class=\"${styles.mapArrow}\"></div>\r\n    `)\r\n    map.addOverlay(label)\r\n  }\r\n\r\n  // 渲染标签\r\n  renderTags() {\r\n    const {\r\n      houseInfo: { tags }\r\n    } = this.state\r\n\r\n    return tags.map((item, index) => {\r\n      // 如果标签数量超过3个，后面的标签就都展示位第三个标签的样式\r\n      let tagClass = ''\r\n      if (index > 2) {\r\n        tagClass = 'tag3'\r\n      } else {\r\n        tagClass = 'tag' + (index + 1)\r\n      }\r\n\r\n      return (\r\n        <span key={item} className={[styles.tag, styles[tagClass]].join(' ')}>\r\n          {item}\r\n        </span>\r\n      )\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      isLoading,\r\n      houseInfo: {\r\n        community,\r\n        title,\r\n        price,\r\n        roomType,\r\n        size,\r\n        floor,\r\n        oriented,\r\n        supporting,\r\n        description\r\n      },\r\n      isFavorite\r\n    } = this.state\r\n    return (\r\n      <div className={styles.root}>\r\n        {/* 导航栏 */}\r\n        <NavHeader\r\n          className={styles.navHeader}\r\n          rightContent={[<i key=\"share\" className=\"iconfont icon-share\" />]}\r\n        >\r\n          {community}\r\n        </NavHeader>\r\n\r\n        {/* 轮播图 */}\r\n        <div className={styles.slides}>\r\n          {!isLoading ? (\r\n            <Carousel autoplay infinite autoplayInterval={5000}>\r\n              {this.renderSwipers()}\r\n            </Carousel>\r\n          ) : (\r\n            ''\r\n          )}\r\n        </div>\r\n\r\n        {/* 房屋基础信息 */}\r\n        <div className={styles.info}>\r\n          <h3 className={styles.infoTitle}>{title}</h3>\r\n          <Flex className={styles.tags}>\r\n            <Flex.Item>{this.renderTags()}</Flex.Item>\r\n          </Flex>\r\n\r\n          <Flex className={styles.infoPrice}>\r\n            <Flex.Item className={styles.infoPriceItem}>\r\n              <div>\r\n                {price}\r\n                <span className={styles.month}>/月</span>\r\n              </div>\r\n              <div>租金</div>\r\n            </Flex.Item>\r\n            <Flex.Item className={styles.infoPriceItem}>\r\n              <div>{roomType}</div>\r\n              <div>房型</div>\r\n            </Flex.Item>\r\n            <Flex.Item className={styles.infoPriceItem}>\r\n              <div>{size}平米</div>\r\n              <div>面积</div>\r\n            </Flex.Item>\r\n          </Flex>\r\n\r\n          <Flex className={styles.infoBasic} align=\"start\">\r\n            <Flex.Item>\r\n              <div>\r\n                <span className={styles.title}>装修：</span>\r\n                精装\r\n              </div>\r\n              <div>\r\n                <span className={styles.title}>楼层：</span>\r\n                {floor}\r\n              </div>\r\n            </Flex.Item>\r\n            <Flex.Item>\r\n              <div>\r\n                <span className={styles.title}>朝向：</span>\r\n                {oriented.join('、')}\r\n              </div>\r\n              <div>\r\n                <span className={styles.title}>类型：</span>普通住宅\r\n              </div>\r\n            </Flex.Item>\r\n          </Flex>\r\n        </div>\r\n\r\n        {/* 地图位置 */}\r\n        <div className={styles.map}>\r\n          <div className={styles.mapTitle}>\r\n            小区：\r\n            <span>{community}</span>\r\n          </div>\r\n          <div className={styles.mapContainer} id=\"map\">\r\n            地图\r\n          </div>\r\n        </div>\r\n\r\n        {/* 房屋配套 */}\r\n        <div className={styles.about}>\r\n          <div className={styles.houseTitle}>房屋配套</div>\r\n          {/* <HousePackage list={supporting} /> */}\r\n          {/* <div className=\"title-empty\">暂无数据</div> */}\r\n\r\n          {supporting.length === 0 ? (\r\n            <div className={styles.titleEmpty}>暂无数据</div>\r\n          ) : (\r\n            <HousePackage list={supporting} />\r\n          )}\r\n        </div>\r\n\r\n        {/* 房屋概况 */}\r\n        <div className={styles.set}>\r\n          <div className={styles.houseTitle}>房源概况</div>\r\n          <div>\r\n            <div className={styles.contact}>\r\n              <div className={styles.user}>\r\n                <img src={BASE_URL + '/img/avatar.png'} alt=\"头像\" />\r\n                <div className={styles.useInfo}>\r\n                  <div>王女士</div>\r\n                  <div className={styles.userAuth}>\r\n                    <i className=\"iconfont icon-auth\" />\r\n                    已认证房主\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <span className={styles.userMsg}>发消息</span>\r\n            </div>\r\n\r\n            <div className={styles.descText}>\r\n              {description || '暂无房屋描述'}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* 推荐 */}\r\n        <div className={styles.recommend}>\r\n          <div className={styles.houseTitle}>猜你喜欢</div>\r\n          <div className={styles.items}>\r\n            {recommendHouses.map(item => (\r\n              <HouseItem {...item} key={item.id} />\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* 底部收藏按钮 */}\r\n        <Flex className={styles.fixedBottom}>\r\n          <Flex.Item onClick={this.handleFavorite}>\r\n            <img\r\n              src={\r\n                BASE_URL + (isFavorite ? '/img/star.png' : '/img/unstar.png')\r\n              }\r\n              className={styles.favoriteImg}\r\n              alt=\"收藏\"\r\n            />\r\n            <span className={styles.favorite}>\r\n              {isFavorite ? '已收藏' : '收藏'}\r\n            </span>\r\n          </Flex.Item>\r\n          <Flex.Item>在线咨询</Flex.Item>\r\n          <Flex.Item>\r\n            <a href=\"tel:400-618-4000\" className={styles.telephone}>\r\n              电话预约\r\n            </a>\r\n          </Flex.Item>\r\n        </Flex>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}